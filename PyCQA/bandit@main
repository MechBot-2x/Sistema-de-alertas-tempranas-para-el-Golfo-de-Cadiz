name: Security Scan
on: [push, pull_request]

jobs:
  bandit-scan:
    runs-on: ubuntu-latest
    permissions:
      security-events: write  # Necesario para reportar resultados
      contents: read
    steps:
      - uses: actions/checkout@v4
      - name: Run Bandit Security Scan
        uses: PyCQA/bandit-action@v1  # Acci√≥n correcta para Bandit
        with:
          args: "-r ./scripts/ -ll"   # Argumentos para Bandit
      - name: Run Bandit with custom settings
  uses: PyCQA/bandit-action@v1
  with:
    args: "-r ./src/ -x tests/ -ll --format json"
    severity: high           # Solo reportar issues de alta severidad
    confidence: medium       # Solo reportar issues con confianza media o alta
    output: bandit-results.json  # Archivo de salida personalizado
